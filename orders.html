diff --git a/orders.html b/orders.html
index 298b0eec799e0f2b0d5ace841cb5694257e25f9c..77d17803d7827bd4b9722fd49aaeafe5f458c67f 100644
--- a/orders.html
+++ b/orders.html
@@ -1,299 +1,178 @@
-diff --git a/orders.html b/orders.html
-index 58c0f57f67baec9268ef5b91d2aaf38bd7ef25dc..0851a5dc9580bc9bfbba83dcb04077fcdbe103f7 100644
---- a/orders.html
-+++ b/orders.html
-@@ -1,32 +1,33 @@
- <!DOCTYPE html>
- <html lang="fr">
- <head>
-   <meta charset="UTF-8">
-   <title>Commandes – Zarbiti Plateforme</title>
-   <meta name="viewport" content="width=device-width,initial-scale=1">
-   <link rel="stylesheet" href="assets/style.css">
-+  <script src="assets/app.js"></script>
- </head>
- <body>
- <div class="login-container" id="locked" style="max-width:500px;">
-   <h1>Accès aux Commandes</h1>
-   <div class="info-msg">Veuillez vous connecter <a href="index.html">ici</a> pour accéder à la gestion des commandes.</div>
- </div>
- <div id="pageContent" class="hidden container" style="max-width:1200px;">
-   <nav>
-     <ul>
-       <li><a href="index.html">Accueil</a></li>
-       <li><a href="production.html">Production</a></li>
-       <li><a href="parcels.html">Livraisons/Colis</a></li>
-       <li><a href="payments.html">Paiements</a></li>
-     </ul>
-     <span class="role-badge" id="roleOrder"></span>
-     <button onclick="logout()" style="float:right;">Déconnexion</button>
-   </nav>
- 
-   <h2>Nouvelle commande</h2>
-   <form id="orderForm" autocomplete="off">
-     <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
-       <div><label>Page source</label>
-         <select name="page">
-           <option>ZARBITI</option>
-           <option>BMT</option>
-@@ -118,156 +119,145 @@
-     Filtrer par status :
-     <select id="filterStatus">
-       <option value="">-- Tous --</option>
-       <option>Nouveau</option>
-       <option>À confirmer</option>
-       <option>Confirmé</option>
-       <option>En production</option>
-       <option>Prêt</option>
-       <option>En livraison</option>
-       <option>Livré</option>
-       <option>Retour</option>
-       <option>Annulé</option>
-     </select>
-   </label>
-   <table id="ordersTable" style="width:100%;margin-top:18px;">
-     <thead></thead>
-     <tbody></tbody>
-   </table>
-   <div style="margin-top:12px;">
-     <button onclick="exportCSV()">Exporter en CSV</button>
-     <button onclick="clearAll()">Tout supprimer</button>
-   </div>
- </div>
- 
- <script>
--const REQUIRED_ROLE = ['admin','vente','confirmation'];
--const ORDER_FIELDS = ["page","usage","carpet_type","model_design","model_image","dimension","quantity","unit_price","delivery_fee","customer_name","customer_phone","customer_address","customer_city","notes","status_pipeline","created_at"];
--const table = document.getElementById('ordersTable');
--const STATUS_OPTIONS = [
--  "Nouveau", "À confirmer", "Confirmé", "En production", "Prêt",
--  "En livraison", "Livré", "Retour", "Annulé"
--];
-+document.addEventListener('DOMContentLoaded', ()=>{
-+  const user = requireAuth(['admin','vente','confirmation'], 'orders.html');
-+  if(!user) return;
- 
--function checkLogin() {
--  let user = localStorage.getItem("zarbiti_user");
--  if(!user){ return false }
--  let obj=JSON.parse(user);
--  if(!REQUIRED_ROLE.includes(obj.role)){ return false }
-   document.getElementById('locked').classList.add('hidden');
-   document.getElementById('pageContent').classList.remove('hidden');
--  document.getElementById('roleOrder').innerText = obj.role.charAt(0).toUpperCase()+obj.role.slice(1);
--  return true;
--}
--window.onload = checkLogin;
-+  applyRoleBadge(document.getElementById('roleOrder'), user.role);
-+  renderNav(user, document.querySelector('nav ul'));
- 
--// Image upload preview
--window.previewImage = function(e){
--  const img = document.getElementById('imgPreview');
--  const file = e.target.files[0];
--  if(!file){ img.style.display="none"; return; }
--  const reader = new FileReader();
--  reader.onload = function(evt){ img.src = evt.target.result; img.style.display="block"; }
--  reader.readAsDataURL(file);
--}
-+  const ORDER_FIELDS = ["page","usage","carpet_type","model_design","model_image","dimension","quantity","unit_price","delivery_fee","customer_name","customer_phone","customer_address","customer_city","notes","status_pipeline","created_at"];
-+  const STATUS_OPTIONS = [
-+    "Nouveau", "À confirmer", "Confirmé", "En production", "Prêt",
-+    "En livraison", "Livré", "Retour", "Annulé",
-+  ];
-+  const table = document.getElementById('ordersTable');
-+  let orders = JSON.parse(localStorage.getItem("zarbiti_orders")||"[]");
- 
--// Load orders
--let orders = JSON.parse(localStorage.getItem("zarbiti_orders")||"[]");
--
--// Add new order
--document.getElementById('orderForm').onsubmit = function(e){
--  e.preventDefault();
--  let f = e.target;
--  let o = {};
--  ORDER_FIELDS.forEach(k=>o[k]=f[k]?.value||"");
--  o.created_at = new Date().toISOString();
--  let imgField = f["model_image"];
--  if(imgField && imgField.files && imgField.files[0]){
--    let reader = new FileReader();
--    reader.onload = function(evt){
--      o.model_image = evt.target.result;
--      orders.push(o);
--      persistOrders();
--      f.reset();
--      document.getElementById('imgPreview').style.display="none";
--      updateTable();
--    }
--    reader.readAsDataURL(imgField.files[0]);
--    return;
-+  window.previewImage = function(e){
-+    const img = document.getElementById('imgPreview');
-+    const file = e.target.files[0];
-+    if(!file){ img.style.display="none"; return; }
-+    const reader = new FileReader();
-+    reader.onload = function(evt){ img.src = evt.target.result; img.style.display="block"; }
-+    reader.readAsDataURL(file);
+<!DOCTYPE html>
+<html lang="fr">
+<head>
+  <meta charset="UTF-8">
+  <title>Commandes – Zarbiti Plateforme</title>
+  <meta name="viewport" content="width=device-width,initial-scale=1">
+  <link rel="stylesheet" href="assets/style.css">
+ <script src="assets/app.js"></script>
+</head>
+<body>
+<div class="login-container" id="locked" style="max-width:500px;">
+  <h1>Accès aux Commandes</h1>
+  <div class="info-msg">Veuillez vous connecter <a href="index.html">ici</a> pour accéder à la gestion des commandes.</div>
+</div>
+<div id="pageContent" class="hidden container" style="max-width:1200px;">
+  <nav>
+    <ul>
+      <li><a href="index.html">Accueil</a></li>
+      <li><a href="production.html">Production</a></li>
+      <li><a href="parcels.html">Livraisons/Colis</a></li>
+      <li><a href="payments.html">Paiements</a></li>
+    </ul>
+    <span class="role-badge" id="roleOrder"></span>
+    <button onclick="logout()" style="float:right;">Déconnexion</button>
+  </nav>
+
+  <h2>Nouvelle commande</h2>
+  <form id="orderForm" autocomplete="off">
+    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
+      <div><label>Page source</label>
+        <select name="page">
+          <option>ZARBITI</option>
+          <option>BMT</option>
+    Filtrer par status :
+    <select id="filterStatus">
+      <option value="">-- Tous --</option>
+      <option>Nouveau</option>
+      <option>À confirmer</option>
+      <option>Confirmé</option>
+      <option>En production</option>
+      <option>Prêt</option>
+      <option>En livraison</option>
+      <option>Livré</option>
+      <option>Retour</option>
+      <option>Annulé</option>
+    </select>
+  </label>
+  <table id="ordersTable" style="width:100%;margin-top:18px;">
+    <thead></thead>
+    <tbody></tbody>
+  </table>
+  <div style="margin-top:12px;">
+    <button onclick="exportCSV()">Exporter en CSV</button>
+    <button onclick="clearAll()">Tout supprimer</button>
+  </div>
+</div>
+
+<script>
+document.addEventListener('DOMContentLoaded', ()=>{
+ const user = requireAuth(['admin','vente','confirmation'], 'orders.html');
+ if(!user) return;
+
+  document.getElementById('locked').classList.add('hidden');
+  document.getElementById('pageContent').classList.remove('hidden');
+ applyRoleBadge(document.getElementById('roleOrder'), user.role);
+ renderNav(user, document.querySelector('nav ul'));
+
+ const ORDER_FIELDS = ["page","usage","carpet_type","model_design","model_image","dimension","quantity","unit_price","delivery_fee","customer_name","customer_phone","customer_address","customer_city","notes","status_pipeline","created_at"];
+ const STATUS_OPTIONS = [
+   "Nouveau", "À confirmer", "Confirmé", "En production", "Prêt",
+   "En livraison", "Livré", "Retour", "Annulé",
+ ];
+ const table = document.getElementById('ordersTable');
+ let orders = JSON.parse(localStorage.getItem("zarbiti_orders")||"[]");
+
+ window.previewImage = function(e){
+   const img = document.getElementById('imgPreview');
+   const file = e.target.files[0];
+   if(!file){ img.style.display="none"; return; }
+   const reader = new FileReader();
+   reader.onload = function(evt){ img.src = evt.target.result; img.style.display="block"; }
+   reader.readAsDataURL(file);
+  }
+
+ document.getElementById('orderForm').onsubmit = function(e){
+   e.preventDefault();
+   const f = e.target;
+   const o = {};
+   ORDER_FIELDS.forEach(k=>o[k]=f[k]?.value||"");
+   o.created_at = new Date().toISOString();
+   const imgField = f["model_image"];
+   if(imgField && imgField.files && imgField.files[0]){
+     const reader = new FileReader();
+     reader.onload = function(evt){
+       o.model_image = evt.target.result;
+       orders.push(o);
+       persistOrders();
+       f.reset();
+       document.getElementById('imgPreview').style.display="none";
+       updateTable();
+     }
+     reader.readAsDataURL(imgField.files[0]);
+     return;
    }
--  orders.push(o);
--  persistOrders();
--  f.reset();
--  document.getElementById('imgPreview').style.display="none";
--  updateTable();
--};
- 
--// Table update
--function updateTable(){
--  let status = document.getElementById('filterStatus').value;
--  let filtered = status ? orders.filter(o=>o.status_pipeline===status) : orders;
--  let thead = "<tr>"+
--    "<th>#</th>"+
--    ORDER_FIELDS.map(f=>"<th>"+f.replace(/_/g," ")+"</th>").join("")+
--    "<th>Statut</th><th>Action</th></tr>";
--  let tbody = filtered.map((o,i)=>{
--    return `<tr>
--      <td>${i+1}</td>
--      ${ORDER_FIELDS.map(f=>
--        f=="model_image"
--          ? `<td>${o[f]?`<img src="${o[f]}" style="max-width:60px;border-radius:6px;">`:""}</td>`
--          : `<td>${o[f]}</td>`
--      ).join("")}
--      <td>
--        <select onchange="changeStatus(${getOrderIndex(o)},this.value)">
--          ${STATUS_OPTIONS.map(s=>`<option value="${s}"${s===o.status_pipeline?' selected':''}>${s}</option>`).join("")}
--        </select>
--      </td>
--      <td><button onclick="deleteOrder(${getOrderIndex(o)})">Supprimer</button></td>
--    </tr>`;
--  }).join("");
--  table.querySelector('thead').innerHTML = thead;
--  table.querySelector('tbody').innerHTML = tbody;
--}
--function getOrderIndex(order){
--  // Need real index from 'orders'
--  return orders.findIndex(o=>o.created_at===order.created_at);
--}
--function changeStatus(idx, newStatus){
--  orders[idx].status_pipeline = newStatus;
--  persistOrders();
--  updateTable();
--}
--function persistOrders(){
--  localStorage.setItem("zarbiti_orders",JSON.stringify(orders));
--}
--window.deleteOrder = function(i){
--  if(confirm("Supprimer cette commande ?")){
--    orders.splice(i,1);
-+  document.getElementById('orderForm').onsubmit = function(e){
-+    e.preventDefault();
-+    const f = e.target;
-+    const o = {};
-+    ORDER_FIELDS.forEach(k=>o[k]=f[k]?.value||"");
-+    o.created_at = new Date().toISOString();
-+    const imgField = f["model_image"];
-+    if(imgField && imgField.files && imgField.files[0]){
-+      const reader = new FileReader();
-+      reader.onload = function(evt){
-+        o.model_image = evt.target.result;
-+        orders.push(o);
-+        persistOrders();
-+        f.reset();
-+        document.getElementById('imgPreview').style.display="none";
-+        updateTable();
-+      }
-+      reader.readAsDataURL(imgField.files[0]);
-+      return;
-+    }
-+    orders.push(o);
+   orders.push(o);
+    persistOrders();
+   f.reset();
+   document.getElementById('imgPreview').style.display="none";
+    updateTable();
+ };
+
+ function updateTable(){
+   const status = document.getElementById('filterStatus').value;
+   const filtered = status ? orders.filter(o=>o.status_pipeline===status) : orders;
+   const thead = "<tr>"+
+     "<th>#</th>"+
+     ORDER_FIELDS.map(f=>"<th>"+f.replace(/_/g," ")+"</th>").join("")+
+     "<th>Statut</th><th>Action</th></tr>";
+   const tbody = filtered.map((o,i)=>{
+     return `<tr>
+       <td>${i+1}</td>
+       ${ORDER_FIELDS.map(f=>
+         f==="model_image"
+           ? `<td>${o[f]?`<img src="${o[f]}" style="max-width:60px;border-radius:6px;">`:""}</td>`
+           : `<td>${o[f]||""}</td>`
+       ).join("")}
+       <td>
+         <select onchange="changeStatus(${getOrderIndex(o)},this.value)">
+           ${STATUS_OPTIONS.map(s=>`<option value="${s}"${s===o.status_pipeline?' selected':''}>${s}</option>`).join("")}
+         </select>
+       </td>
+       <td><button onclick="deleteOrder(${getOrderIndex(o)})">Supprimer</button></td>
+     </tr>`;
+   }).join("");
+   table.querySelector('thead').innerHTML = thead;
+   table.querySelector('tbody').innerHTML = tbody;
+  }
+
+ function getOrderIndex(order){
+   return orders.findIndex(o=>o.created_at===order.created_at);
+ }
+ window.changeStatus = function(idx, newStatus){
+   orders[idx].status_pipeline = newStatus;
+    persistOrders();
+    updateTable();
+  }
+ function persistOrders(){
+   localStorage.setItem("zarbiti_orders",JSON.stringify(orders));
+ }
+ window.deleteOrder = function(i){
+   if(confirm("Supprimer cette commande ?")){
+     orders.splice(i,1);
      persistOrders();
-+    f.reset();
-+    document.getElementById('imgPreview').style.display="none";
      updateTable();
-+  };
-+
-+  function updateTable(){
-+    const status = document.getElementById('filterStatus').value;
-+    const filtered = status ? orders.filter(o=>o.status_pipeline===status) : orders;
-+    const thead = "<tr>"+
-+      "<th>#</th>"+
-+      ORDER_FIELDS.map(f=>"<th>"+f.replace(/_/g," ")+"</th>").join("")+
-+      "<th>Statut</th><th>Action</th></tr>";
-+    const tbody = filtered.map((o,i)=>{
-+      return `<tr>
-+        <td>${i+1}</td>
-+        ${ORDER_FIELDS.map(f=>
-+          f==="model_image"
-+            ? `<td>${o[f]?`<img src="${o[f]}" style="max-width:60px;border-radius:6px;">`:""}</td>`
-+            : `<td>${o[f]||""}</td>`
-+        ).join("")}
-+        <td>
-+          <select onchange="changeStatus(${getOrderIndex(o)},this.value)">
-+            ${STATUS_OPTIONS.map(s=>`<option value="${s}"${s===o.status_pipeline?' selected':''}>${s}</option>`).join("")}
-+          </select>
-+        </td>
-+        <td><button onclick="deleteOrder(${getOrderIndex(o)})">Supprimer</button></td>
-+      </tr>`;
-+    }).join("");
-+    table.querySelector('thead').innerHTML = thead;
-+    table.querySelector('tbody').innerHTML = tbody;
    }
--}
--function exportCSV(){
--  let csv = ORDER_FIELDS.join(";")+"\n";
--  csv += orders.map(o=>ORDER_FIELDS.map(f=>'"'+(o[f]||"")+'"').join(";')).join("\n");
--  const link = document.createElement('a');
--  link.href = "data:text/csv;charset=utf-8," + encodeURIComponent(csv);
--  link.download = "zarbiti-commandes.csv";
--  document.body.appendChild(link); link.click(); document.body.removeChild(link);
--}
--function clearAll(){
--  if(confirm("Tout supprimer ?")){
--    orders = [];
-+
-+  function getOrderIndex(order){
-+    return orders.findIndex(o=>o.created_at===order.created_at);
-+  }
-+  window.changeStatus = function(idx, newStatus){
-+    orders[idx].status_pipeline = newStatus;
+ }
+ window.exportCSV = function(){
+   let csv = ORDER_FIELDS.join(";")+"\n";
+   csv += orders.map(o=>ORDER_FIELDS.map(f=>'"'+(o[f]||"")+'"').join(";")).join("\n");
+   const link = document.createElement('a');
+   link.href = "data:text/csv;charset=utf-8," + encodeURIComponent(csv);
+   link.download = "zarbiti-commandes.csv";
+   document.body.appendChild(link); link.click(); document.body.removeChild(link);
+ }
+ window.clearAll = function(){
+   if(confirm("Tout supprimer ?")){
+     orders = [];
      persistOrders();
      updateTable();
    }
--}
--document.getElementById('filterStatus').onchange = updateTable;
--window.logout = function(){
--  localStorage.removeItem("zarbiti_user");
--  location.href="index.html";
--}
--updateTable();
-+  function persistOrders(){
-+    localStorage.setItem("zarbiti_orders",JSON.stringify(orders));
-+  }
-+  window.deleteOrder = function(i){
-+    if(confirm("Supprimer cette commande ?")){
-+      orders.splice(i,1);
-+      persistOrders();
-+      updateTable();
-+    }
-+  }
-+  window.exportCSV = function(){
-+    let csv = ORDER_FIELDS.join(";")+"\n";
-+    csv += orders.map(o=>ORDER_FIELDS.map(f=>'"'+(o[f]||"")+'"').join(";")).join("\n");
-+    const link = document.createElement('a');
-+    link.href = "data:text/csv;charset=utf-8," + encodeURIComponent(csv);
-+    link.download = "zarbiti-commandes.csv";
-+    document.body.appendChild(link); link.click(); document.body.removeChild(link);
-+  }
-+  window.clearAll = function(){
-+    if(confirm("Tout supprimer ?")){
-+      orders = [];
-+      persistOrders();
-+      updateTable();
-+    }
-+  }
-+
-+  document.getElementById('filterStatus').onchange = updateTable;
-+  updateTable();
-+});
- </script>
- </body>
- </html>
+ }
+
+ document.getElementById('filterStatus').onchange = updateTable;
+ updateTable();
+});
+</script>
+</body>
+</html>
